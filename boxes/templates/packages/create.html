{% extends "base.html" %}

{% block content %}
    <h2>Create Package</h2>

    <a href="{% url 'packages' %}" class="btn btn-secondary mt-2">Back to All Packages</a>

    {% include "_messages.html" %}

    {% include "packages/_createbox.html" %}


    <!-- should use Hotwire instead of duplicating code... TODO -->
    <div class="table-responsive mt-3">
        <table class="table table-bordered">
            <thead class="thead-dark">
                <tr>
                    <th>Customer</th>
                    <th>Price</th>
                    <th>Carrier</th>
                    <th>Type</th>
                    <th>Type Description</th>
                    <th>Tracking Code</th>
                </tr>
            </thead>
            <tbody>
                <tr class="visually-hidden">
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
            </tbody>
        </table>
    </div>

    <script>
        document.getElementById("createbtn").addEventListener("click", function() {
            var tracking_code = document.getElementById("id_tracking_code").value;
            var price = document.getElementById("id_price").value;
            var carrier = $("#id_carrier_id").find(":selected").text();
            var account = $("#id_account_id").find(":selected").text();
            var type = $("#id_package_type_id").find(":selected").text();

            var new_row = document.querySelector('.visually-hidden').cloneNode(true);
            new_row.classList.remove("visually-hidden");
            new_row.querySelector("td:nth-child(1)").innerText = account;
            new_row.querySelector("td:nth-child(2)").innerText = price;
            new_row.querySelector("td:nth-child(3)").innerText = carrier;
            new_row.querySelector("td:nth-child(5)").innerText = type;
            new_row.querySelector("td:nth-child(6)").innerText = tracking_code;
            document.querySelector("tbody").appendChild(new_row);

            console.log("Price:", price);
            console.log("Tracking code:", tracking_code);
            console.log("Carrier:", carrier);
            console.log("Customer:", account);
            console.log("Type:", type);
        });
    </script>
{% endblock %}
